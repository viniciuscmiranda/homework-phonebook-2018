#include <iostream>
#include <locale.h>

using namespace std;

int contagemContato=0, totalContato=31, totalInfo=3;
string contato[31/*totalContato*/][3/*totalInfo*/], info[3/*totalInfo*/]={"Nome", "Tel.", "E-mail"};
string semcontato=" Você não possui contatos.";

void addcontato(){
    if(contagemContato<totalContato-1){
        for(int i=0; i<totalInfo; i++){
            cout<<" Digite o "<<info[i]<<": ";
            cin>>contato[contagemContato][i];
        }
        for(int i=0; i<=totalContato; i++){
            if(contato[contagemContato][0]==contato[i][0] && i!=contagemContato){
                cout<<"\n Contato já existente.";
                break;
            }
            else if(i==totalContato){
                cout<<"\n Contato adicionado!";
                contagemContato++;
                break;
            }
        }
    } else{
        cout<<" Lista cheia!";
    }
}

void edtcontato(){
    string editar;
    string auxcontato[totalInfo];
    for(int i=0; i<totalInfo; i++){
        auxcontato[i]=" ";
    }

    if(contagemContato>0){
        cout<<" Insira o nome do contato: ";
        cin>>editar;

        for(int i=0; i<=contagemContato; i++){
            if(editar==contato[i][0]){
                cout<<"\n >";
                for(int i2=0; i2<totalInfo; i2++){
                    cout<<" "<<info[i2]<<": "<<contato[i][i2]<<" |";
                    auxcontato[i2]=contato[i][i2];
                }
                cout<<endl<<endl;
                for(int i2=0; i2<totalInfo; i2++){
                    cout<<" Digite o "<<info[i2]<<": ";
                    cin>>contato[i][i2];
                }
                for(int i2=0; i2<=contagemContato; i2++){
                    if(contato[i][0]==contato[i2][0] && i2!=i){
                        for(int i3=0; i3<totalInfo; i3++){
                            contato[i][i3]=auxcontato[i3];
                        }
                        cout<<"\n Contato já existente.";
                        break;
                    }
                    else if(i2==contagemContato){
                        cout<<"\n Contato atualizado!";
                        break;
                    }
                }
            }
            if(auxcontato[0]!=" "){break;}
            if(i==contagemContato){ cout<<"\n Contato não encontrado."; break;}
        }
    } else{cout<<semcontato;}
}

void rmvcontato(){
    string remover;

    if(contagemContato>0){
        cout<<" Insira o nome do contato: ";
        cin>>remover;

        for(int i=0; i<totalContato; i++){
            if(remover==contato[i][0]){
                for(int i2=i; i2<totalContato; i2++){
                    for(int i3=0; i3<totalInfo; i3++){
                        contato[i2][i3]=contato[i2+1][i3];
                    }
                }
                cout<<"\n Contato removido!";
                contagemContato--;
                break;
                }
            if(i==totalContato-1){ cout<<"\n Contato não encontrado."; break;}
        }
    } else{cout<<semcontato;}
}

void psqcontato(){
    string pesquisar;
    int resultado=0;

    if(contagemContato>0){
        cout<<" Pesquisar: ";
        cin>>pesquisar;

        for(int i=0; i<totalContato; i++){
            if(contato[i][0]==pesquisar||contato[i][1]==pesquisar||contato[i][2]==pesquisar){
                resultado++;
            }
        }
        if(resultado>0){
            cout<<" "<<resultado<<" Resultado";
            if(resultado>1){cout<<"s.\n\n";}
            else{cout<<".\n\n";}

            for(int i=0; i<contagemContato; i++){
                if (contato[i][0]==pesquisar||contato[i][1]==pesquisar||contato[i][2]==pesquisar){
                    cout<<" >";
                    for(int i2=0; i2<totalInfo; i2++){
                        cout<<" "<<info[i2]<<": "<<contato[i][i2]<<" |";
                    }
                    resultado--;
                    cout<<endl;
                    if(resultado>0){
                        cout<<"_______________________________________________________________________________________________________________\n\n";
                    }
                }
            }
        }
        else{cout<<" Sem resultados.";}
    } else{cout<<semcontato;}
}

void exbcontato(){
    if(contagemContato>0){
        for(int i=0; i<contagemContato; i++){
            cout<<" >";
            for(int i2=0; i2<totalInfo; i2++){
                cout<<" "<<info[i2]<<": "<<contato[i][i2]<<" |";
            }
            if(i<contagemContato-1){
                cout<<"\n_______________________________________________________________________________________________________________\n\n";
            }
        }
        cout<<endl;
    } else{cout<<semcontato;}
}

int main(){
    setlocale(LC_ALL, "portuguese");
    int menu=1;

    for(int i=0; i<totalContato; i++){
        for(int i2=0; i2<totalInfo; i2++){
            contato[i][i2]=" ";
        }
    }

    while(menu>0 && menu<6){
        cout<<
        endl<<"-------------Menu-------------"<<
        endl<<"                             |"<<
        endl<<" 1 - Adicionar Contato       |"<<
        endl<<" 2 - Editar Contato          |"<<
        endl<<" 3 - Remover Contato         |"<<
        endl<<" 4 - Pesquisar               |"<<
        endl<<" 5 - Exibir Todos            |"<<
        endl<<" 6 - Sair                    |"<<
        endl<<"                             |"<<
        endl<<"------------------------------";

        cout<<"\n\n Selecione uma opção: ";
        cin>>menu;

        cout<<endl<<endl;

        switch(menu){
            case 1: addcontato(); break;
            case 2: edtcontato(); break;
            case 3: rmvcontato(); break;
            case 4: psqcontato(); break;
            case 5: exbcontato(); break;
            default:
                cout<<" Tem certeza?\n 1-Continuar | 2-Sair: ";
                cin>>menu;
                if(menu!=1){menu=10;}
        }
        cout<<endl;
    }
}
